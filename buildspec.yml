version: 0.2

phases:
  install:
    commands:
      - echo "Updating package lists..."
      - yum -y update
      - echo "Installing Amazon Corretto 17..."
      - yum -y install java-17-amazon-corretto-devel
      - echo "Installing Maven..."
      - yum -y install maven

  pre_build:
    commands:
      - echo "Setting JAVA_HOME and PATH..."
      - export JAVA_HOME=/usr/lib/jvm/java-17-amazon-corretto
      - export PATH=$JAVA_HOME/bin:$PATH
      - echo "JAVA_HOME is set to $JAVA_HOME"
      - echo "PATH is set to $PATH"
      - echo "Checking Maven version..."
      - JAVA_HOME=/usr/lib/jvm/java-17-amazon-corretto mvn --version

  build:
    commands:
      - echo "Build started on `date`"
      - echo "Compiling the Maven project..."
      - JAVA_HOME=/usr/lib/jvm/java-17-amazon-corretto mvn compile
      - echo "Running tests..."
      - JAVA_HOME=/usr/lib/jvm/java-17-amazon-corretto mvn test
      - echo "Packaging the application..."
      - JAVA_HOME=/usr/lib/jvm/java-17-amazon-corretto mvn package

artifacts:
  files:
    - '**/*'
 
